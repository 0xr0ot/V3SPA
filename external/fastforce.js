function d3_layout_forceDragstart(t){t.fixed|=2}function d3_layout_forceDragend(t){t.fixed&=-7}function d3_layout_forceMouseover(t){t.fixed|=4,t.px=t.x,t.py=t.y}function d3_layout_forceMouseout(t){t.fixed&=-5}function d3_layout_forceAccumulate(t,e,n){var r=0,a=0;if(t.charge=0,!t.leaf)for(var o,i=t.nodes,u=i.length,f=-1;++f<u;)o=i[f],null!=o&&(d3_layout_forceAccumulate(o,e,n),t.charge+=o.charge,r+=o.charge*o.cx,a+=o.charge*o.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var c=e*n[t.point.index];t.charge+=t.pointCharge=c,r+=c*t.point.x,a+=c*t.point.y}t.cx=r/t.charge,t.cy=a/t.charge}d3.layout.fastForce=function(){function t(t){var e,n,r,a,o=Math.floor(Math.random()*k.length),i=k[o],u=(t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y),f=-(1/0),c=-1;if(!(t.nearest.indexOf(o)>=0)){for(;++c<t.nearest.length;)e=t.nearest[c],n=k[e],r=(t.x-n.x)*(t.x-n.x)+(t.y-n.y)*(t.y-n.y),r>f&&(a=c,f=r);f>u&&(t.nearest[a]=o)}}function e(t,e){e=Math.floor(e);var n,r,a,o=k.length,i=o-e;for(n=o-1;n>=i;--n)r=Math.floor(Math.random()*n),a=t[r],t[r]=t[n],t[n]=a;return t.slice(i)}function n(n){var r,a,o,i,f,c,h,y,l=k.length;l-Math.sqrt(l);for(t(n),a=e(s,Math.sqrt(l)),n.vy=0,n.vx=0,r=a.length-1;r>=0;--r)i=k[a[r]],n.nearest.indexOf(i)>=0||(c=i.x-n.x,h=i.y-n.y,y=c*c+h*h,y&&_>y&&(f=u*g[i.index]*a.length/y,n.vx+=c*f,n.vy+=h*f));for(o=n.nearest,r=o.length-1;r>=0;--r)i=k[o[r]],c=i.x-n.x,h=i.y-n.y,y=c*c+h*h,y&&_>y&&(f=u*g[i.index]/y,n.vx+=c*f,n.vy+=h*f);n.px-=n.vx,n.py-=n.vy}function r(e){var n,r,a,o,i,f,c,h=k.length;h-Math.sqrt(h);for(t(e),r=e.nearest,e.vx*=.92,e.vy*=.92,n=r.length-1;n>=0;--n)a=k[r[n]],i=a.x-e.x,f=a.y-e.y,c=i*i+f*f,c&&_>c&&(o=u*g[a.index]/c,e.vx+=i*o,e.vy+=f*o);e.px-=e.vx,e.py-=e.vy}function a(t){t.px=d3.event.x,t.py=d3.event.y,y.resume()}var o,i,u,f,c,g,h,s,y={},l=d3.dispatch("start","tick","end"),x=[1,1],d=.9,p=d3_layout_forceLinkDistance,v=d3_layout_forceLinkStrength,m=-30,_=d3_layout_forceChargeDistance2,M=.1,N=.64,k=[],D=[],w=[];return y.tick=function(){if((u*=.98)<24e-5)return o=null,l.end({type:"end",alpha:u=0,mean:d3.mean(w)}),!0;var t,a,i,g,s,y,p,v,_,N,q=(new Date).getTime(),b=k.length,L=D.length;for(i=0;L>i;++i)g=D[i],s=g.source,y=g.target,_=y.x-s.x,N=y.y-s.y,(p=_*_+N*N)&&(p=u*c[i]*((p=Math.sqrt(p))-f[i])/p,_*=p,N*=p,y.x-=_*(v=s.weight+y.weight?s.weight/(s.weight+y.weight):.5),y.y-=N*v,s.x+=_*(v=1-v),s.y+=N*v);if((v=u*M)&&(_=x[0]/2,N=x[1]/2,i=-1,v))for(;++i<b;)g=k[i],g.x+=(_-g.x)*v,g.y+=(N-g.y)*v;if(m){for(t=e(h,b),a=Math.sqrt(b),i=-1;++i<a;)n(k[t[i]]);for(--i;++i<b;)g=k[t[i]],r(g),g.px-=g.vx,g.py-=g.vy}for(i=-1;++i<b;)g=k[i],g.fixed?(g.x=g.px,g.y=g.py):(g.x-=(g.px-(g.px=g.x))*d,g.y-=(g.py-(g.py=g.y))*d);w.push((new Date).getTime()-q),l.tick({type:"tick",alpha:u})},y.nodes=function(t){return arguments.length?(k=t,y):k},y.links=function(t){return arguments.length?(D=t,y):D},y.size=function(t){return arguments.length?(x=t,y):x},y.linkDistance=function(t){return arguments.length?(p="function"==typeof t?t:+t,y):p},y.distance=y.linkDistance,y.linkStrength=function(t){return arguments.length?(v="function"==typeof t?t:+t,y):v},y.friction=function(t){return arguments.length?(d=+t,y):d},y.charge=function(t){return arguments.length?(m="function"==typeof t?t:+t,y):m},y.chargeDistance=function(t){return arguments.length?(_=t*t,y):Math.sqrt(_)},y.gravity=function(t){return arguments.length?(M=+t,y):M},y.theta=function(t){return arguments.length?(N=t*t,y):Math.sqrt(N)},y.alpha=function(t){return arguments.length?(t=+t,u?t>0?u=t:l.end({type:"end",alpha:u=0}):t>0&&(l.start({type:"start",alpha:u=t}),o=d3.timer(y.tick)),y):u},y.start=function(){function t(t,e){if(!r){for(r=new Array(o),c=0;o>c;++c)r[c]=[];for(c=0;i>c;++c){var a=D[c];r[a.source.index].push(a.target),r[a.target.index].push(a.source)}}for(var u,f=r[n],c=-1,g=f.length;++c<g;)if(!isNaN(u=f[c][t]))return u+Math.random()-.5;return Math.random()*e}var n,r,a,o=k.length,i=D.length,u=x[0],l=x[1];for(h=d3.range(0,o),s=d3.range(0,o),n=0;o>n;++n)(a=k[n]).index=n,a.weight=0;for(n=0;i>n;++n)a=D[n],"number"==typeof a.source&&(a.source=k[a.source]),"number"==typeof a.target&&(a.target=k[a.target]),++a.source.weight,++a.target.weight;for(n=0;o>n;++n)a=k[n],isNaN(a.x)&&(a.x=t("x",u)),isNaN(a.y)&&(a.y=t("y",l)),isNaN(a.px)&&(a.px=a.x),isNaN(a.py)&&(a.py=a.y),isNaN(a.vx)&&(a.vx=0),isNaN(a.vy)&&(a.vy=0),a.nearest=e(s,Math.sqrt(o));if(f=[],"function"==typeof p)for(n=0;i>n;++n)f[n]=+p.call(this,D[n],n);else for(n=0;i>n;++n)f[n]=p;if(c=[],"function"==typeof v)for(n=0;i>n;++n)c[n]=+v.call(this,D[n],n);else for(n=0;i>n;++n)c[n]=v;if(g=[],"function"==typeof m)for(n=0;o>n;++n)g[n]=+m.call(this,k[n],n);else for(n=0;o>n;++n)g[n]=m;return y.resume()},y.resume=function(){return y.alpha(.1)},y.stop=function(){return y.alpha(0)},y.drag=function(){return i||(i=d3.behavior.drag().origin(function(t){return t}).on("dragstart.force",d3_layout_forceDragstart).on("drag.force",a).on("dragend.force",d3_layout_forceDragend)),arguments.length?void this.on("mouseover.force",d3_layout_forceMouseover).on("mouseout.force",d3_layout_forceMouseout).call(i):i},d3.rebind(y,l,"on")};var d3_layout_forceLinkDistance=20,d3_layout_forceLinkStrength=1,d3_layout_forceChargeDistance2=1/0;